<!DOCTYPE html>
<html>
<head>
    <title>Admin Management</title>
	<style>
	       body {
	           font-family: Arial, sans-serif;
	           background: linear-gradient(to right, #74ebd5, #acb6e5);
	           color: #333;
	           margin: 0;
	           padding: 0;
	           display: flex;
			   justify-content: center;
	           flex-direction: column;
	           align-items: center;
	           min-height: 100vh;
	       }

		   header {
		   				background-color: #2C3E50;
		   				color: white;
		   				padding: 20px 0;
		   			    text-align: center;
		   				width: 100%;
		   				z-index: 1000;
		   				box-shadow: 0 4px 8px rgba(0,0,0,0.1);
		   			    position: fixed;
		   				top: 0;
		   				display: flex;
		   				justify-content: center;
		   				align-items: center;
		   			}

		   			header h1 {
		   			    margin: 0;
		   			    font-size: 2.5em;
		   			    animation: fadeIn 2s;
		   			}

	       .container {
	           text-align: center;
	           margin-top: 100px; /* Adjust as needed */
	           background: rgba(255, 255, 255, 0.2);
	           padding: 40px 60px;
	           border-radius: 15px;
	           box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
	           backdrop-filter: blur(10px);
	           animation: slideIn 1s ease-in-out;
	           width: 100%; /* Adjust width as needed */
	           max-width: 600px; /* Example maximum width */
	           margin-bottom: 50px; /* Space at the bottom */
	       }
		   
		   label {
		   	    font-weight: bold;
		   	    display: block;
		   	    margin-bottom: 5px;
		   	    color: #333;
		   	}

		   	input[type="text"], input[type="password"] {
		   	    width: calc(100% - 20px);
		   	    padding: 10px;
		   	    margin-bottom: 10px;
		   	    border: 1px solid #ccc;
		   	    border-radius: 5px;
		   	    box-sizing: border-box;
		   	}

	       .admin-form, .admin-table, .login-form {
	           background: #fff;
	           padding: 20px;
	           margin: 20px 0;
	           border-radius: 10px;
	           box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
	       }

	       .admin-table, .hidden {
	           width: 100%;
	       }

	       table {
	           width: 100%;
	           border-collapse: collapse;
	       }

	       th, td {
	           padding: 10px;
	           border: 1px solid #ddd;
	       }

	       th {
	           background-color: #f4f4f4;
	       }

	       button {
	           padding: 10px;
	           background: #ff7eb3;
	           color: #fff;
	           border: none;
	           border-radius: 30px;
	           cursor: pointer;
	           transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
	           font-size: 1em;
	           font-weight: bold;
	           box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
	       }

	       button:hover {
	           background: #ff758c;
	           transform: translateY(-5px);
	           box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
	       }

	       .hidden {
	           display: none;
	       }

	       footer {
	           text-align: center;
	           padding: 10px 0;
	           background-color: #2C3E50;
	           color: white;
	           position: fixed;
	           width: 100%;
	           bottom: 0;
	           box-shadow: 0 -4px 8px rgba(0,0,0,0.1);
	           animation: fadeIn 2s;
	       }

	       footer p {
	           margin: 0;
	       }

	       @keyframes fadeIn {
	           0% { opacity: 0; }
	           100% { opacity: 1; }
	       }

	       @keyframes slideIn {
	           0% { transform: translateY(20px); opacity: 0; }
	           100% { transform: translateY(0); opacity: 1; }
	       }
	   </style>
</head>
<body>
	<header>
		<h1>Flaw Tracking System</h1>
	</header>
    <h2>Admin Management</h2>

    <div class="login-form">
        <h2>Admin Login</h2>
        <form id="adminLoginForm">
            <label for="adminUsername">Username:</label>
            <input type="text" id="adminUsername" name="username" required>
            <br>
            <label for="adminPassword">Password:</label>
            <input type="password" id="adminPassword" name="password" required>
            <br>
            <button type="submit" id="loginButton">Login</button>
        </form>
    </div>

	<div id="adminManagement" class="hidden">
	        <div class="admin-form">
	            <h2>Add Admin</h2>
	            <form id="addAdminForm">
	                <label for="adminUserName">Username:</label>
	                <input type="text" id="adminUserName" name="username" required>
	                <br>
	                <label for="adminpassword">Password:</label>
	                <input type="password" id="adminpassword" name="password" required>
	                <br>
	                <button type="submit">Add Admin</button>
	            </form>
	        </div>


		<div class="admin-table">
		            <h2>Admin List</h2>
		            <table>
		                <thead>
		                    <tr>
		                        <th>ID</th>
		                        <th>Username</th>
								<th>Password</th>
		                        <th>Actions</th>
		                    </tr>
		                </thead>
		                <tbody id="adminList">
		                    <!-- Admins will be loaded here -->
		                </tbody>
		            </table>
		        </div>

        <div class="admin-table">
            <h2>User List</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
						<th>Password</th>
                        <th>Phone Number</th>
                        <th>Role</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="userList">
                    <!-- Users will be loaded here -->
                </tbody>
            </table>
        </div>

        <div class="admin-table">
            <h2>Flaw List</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Application</th>
                        <th>Module</th>
                        <th>Description</th>
                        <th>Assigned To</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="flawList">
                    <!-- Flaws will be loaded here -->
                </tbody>
            </table>
        </div>
    </div>
	
	<footer>
		 <p>&copy; 2024 Flaw Tracking System. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const adminList = document.getElementById('adminList');
            const userList = document.getElementById('userList');
            const flawList = document.getElementById('flawList');
            const adminManagement = document.getElementById('adminManagement');
			
			document.addEventListener('DOMContentLoaded', function() {
			    const loginButton = document.getElementById('loginButton');
			    if (loginButton) {
			        loginButton.addEventListener('click', function() {
			            const username = document.getElementById('adminUsername').value;
			            const password = document.getElementById('adminPassword').value;

			            fetch('http://localhost:8088/flawtrack/api/admins/login', {
			                method: 'POST',
			                headers: {
			                    'Content-Type': 'application/json',
			                },
			                body: JSON.stringify({ username, password }),
			            })
			            .then(response => {
			                if (response.ok) {
			                    // Handle successful login
			                    console.log('Login successful');
			                } else {
			                    // Handle login failure
			                    console.log('Login failed');
			                }
			            })
			            .catch(error => {
			                console.error('Error during login:', error);
			            });
			        });
			    }
			});

            function loadAdmins() {
                fetch('/flawtrack/api/admins')
                    .then(response => response.json())
                    .then(admins => {
                        adminList.innerHTML = '';
                        admins.forEach(admin => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${admin.id}</td>
                                <td>${admin.username}</td>
								<td>${admin.password}</td>
                                <td>
                                    <button onclick="editAdmin(${admin.id})">Edit</button>
                                    <button onclick="deleteAdmin(${admin.id})">Delete</button>
                                </td>
                            `;
                            adminList.appendChild(row);
                        });
                    });
            }

            function loadUsers() {
                fetch('/flawtrack/api/admins/users')
                    .then(response => response.json())
                    .then(users => {
                        userList.innerHTML = '';
                        users.forEach(user => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${user.id}</td>
                                <td>${user.name}</td>
                                <td>${user.email}</td>
								<td>${user.password}</td>
                                <td>${user.phoneno}</td>
                                <td>${user.role}</td>
                                <td>
                                    <button onclick="editUser(${user.id})">Edit</button>
                                    <button onclick="deleteUser(${user.id})">Delete</button>
                                </td>
                            `;
                            userList.appendChild(row);
                        });
                    });
            }

            function loadFlaws() {
                fetch('/flawtrack/api/admins/flaws')
                    .then(response => response.json())
                    .then(flaws => {
                        flawList.innerHTML = '';
                        flaws.forEach(flaw => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${flaw.id}</td>
                                <td>${flaw.application}</td>
                                <td>${flaw.module}</td>
                                <td>${flaw.description}</td>
                                <td>${flaw.assignedTo}</td>
                                <td>${flaw.status}</td>
                                <td>
                                    <button onclick="editFlaw(${flaw.id})">Edit</button>
                                    <button onclick="deleteFlaw(${flaw.id})">Delete</button>
                                </td>
                            `;
                            flawList.appendChild(row);
                        });
                    });
            }

            function addAdmin(event) {
                event.preventDefault();
                const username = document.getElementById('adminUserName').value;
                const password = document.getElementById('adminpassword').value;
                

                fetch('/flawtrack/api/admins', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                })
                .then(response => response.json())
                .then(admin => {
                    loadAdmins();
                    document.getElementById('addAdminForm').reset();
                });
            }
			
			// Function to edit Admin
			        window.editAdmin = function(id) {
			            const username = prompt('Enter new username:');
			            const password = prompt('Enter new password:');
			            
			            if (username && password) {
			                fetch(`/flawtrack/api/admins/${id}`, {
			                    method: 'PUT',
			                    headers: {
			                        'Content-Type': 'application/json'
			                    },
			                    body: JSON.stringify({ username, password })
			                })
			                .then(response => {
			                    if (response.ok) {
			                        loadAdmins();
			                    } else {
			                        alert('Failed to update admin');
			                    }
			                });
			            }
			        }

			        // Function to delete Admin
			        window.deleteAdmin = function(id) {
			            if (confirm('Are you sure you want to delete this admin?')) {
			                fetch(`/flawtrack/api/admins/${id}`, {
			                    method: 'DELETE'
			                })
			                .then(response => {
			                    if (response.ok) {
			                        loadAdmins();
			                    } else {
			                        alert('Failed to delete admin');
			                    }
			                });
			            }
			        }

			        // Function to edit User
			        window.editUser = function(id) {
			            const name = prompt('Enter new name:');
			            const email = prompt('Enter new email:');
						const password=prompt('Enter new password:')
			            const phoneno = prompt('Enter new phone number:');
			            const role = prompt('Enter new role:');

			            if (name && email && password && phoneno && role) {
			                fetch(`/flawtrack/api/admins/users/${id}`, {
			                    method: 'PUT',
			                    headers: {
			                        'Content-Type': 'application/json'
			                    },
			                    body: JSON.stringify({ name, email, password, phoneno, role })
			                })
			                .then(response => {
			                    if (response.ok) {
			                        loadUsers();
			                    } else {
			                        alert('Failed to update user');
			                    }
			                });
			            }
			        }

			        // Function to delete User
			        window.deleteUser = function(id) {
			            if (confirm('Are you sure you want to delete this user?')) {
			                fetch(`/flawtrack/api/admins/users/${id}`, {
			                    method: 'DELETE'
			                })
			                .then(response => {
			                    if (response.ok) {
			                        loadUsers();
			                    } else {
			                        alert('Failed to delete user');
			                    }
			                });
			            }
			        }

			        // Function to edit Flaw
			        window.editFlaw = function(id) {
			            const application = prompt('Enter new application:');
			            const module = prompt('Enter new module:');
			            const description = prompt('Enter new description:');
			            const assignedTo = prompt('Enter new assigned to:');
			            const status = prompt('Enter new status:');

			            if (application && module && description && assignedTo && status) {
			                fetch(`/flawtrack/api/admins/flaws/${id}`, {
			                    method: 'PUT',
			                    headers: {
			                        'Content-Type': 'application/json'
			                    },
			                    body: JSON.stringify({ application, module, description, assignedTo, status })
			                })
			                .then(response => {
			                    if (response.ok) {
			                        loadFlaws();
			                    } else {
			                        alert('Failed to update flaw');
			                    }
			                });
			            }
			        }

			        // Function to delete Flaw
			        window.deleteFlaw = function(id) {
			            if (confirm('Are you sure you want to delete this flaw?')) {
			                fetch(`/flawtrack/api/admins/flaws/${id}`, {
			                    method: 'DELETE'
			                })
			                .then(response => {
			                    if (response.ok) {
			                        loadFlaws();
			                    } else {
			                        alert('Failed to delete flaw');
			                    }
			                });
			            }
			        }

         

            function loginAdmin(event) {
                event.preventDefault();
                const username = document.getElementById('adminUsername').value;
                const password = document.getElementById('adminPassword').value;

                fetch('/flawtrack/api/admins/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                })
                .then(response => {
                    if (response.ok) {
                        document.querySelector('.login-form').classList.add('hidden');
                        adminManagement.classList.remove('hidden');
                        loadAdmins();
                        loadUsers();
                        loadFlaws();
                    } else {
                        alert('Invalid credentials');
                    }
                });
            }

            document.getElementById('adminLoginForm').addEventListener('submit', loginAdmin);
            document.getElementById('addAdminForm').addEventListener('submit', addAdmin);
            
            
        });
    </script>
</body>
</html>
